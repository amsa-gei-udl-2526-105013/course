<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ca" xml:lang="ca"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jordi Mateo FornÃ©s jordi.mateo@udl.cat">

<title>PrÃ ctica 04: DockeritzaciÃ³ i OrquestraciÃ³ dâ€™una API a AWS â€“ AMSA - Fall 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-c30451789a0a2bcd5e941535c675cd30.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Cap resultat",
    "search-matching-documents-text": "documents que coincideixen",
    "search-copy-link-title": "Copia l'enllaÃ§ a la cerca",
    "search-hide-matches-text": "Amaga les coincidÃ¨ncies addicionals",
    "search-more-match-text": "altra coincidÃ¨ncia en aquest document",
    "search-more-matches-text": "altres coincidÃ¨ncies en aquest document",
    "search-clear-button-title": "Neteja",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "CancelÂ·la",
    "search-submit-button-title": "Envia",
    "search-label": "Cerca"
  }
}</script>


</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Commuta la navegaciÃ³ de la barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../projects/01-project/01-project.html">Projectes</a></li><li class="breadcrumb-item"><a href="../../projects/04-project/04-project.html">Projecte 4 Â· DockeritzaciÃ³ i OrquestraciÃ³ dâ€™una API a AWS</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Commuta la navegaciÃ³ de la barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../figs/logo.png" alt="AMSA Logo" class="sidebar-logo light-content py-0 d-lg-inline d-none">
      <img src="../../figs/logo.png" alt="AMSA Logo" class="sidebar-logo dark-content py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main tools-wide">
    <a href="../../index.html" title="Home" class="quarto-navigation-tool px-1" aria-label="Home"><i class="bi bi-house"></i></a>
    <a href="https://github.com/amsa-gei-udl-2526-105013/course/" title="GitHub organization" class="quarto-navigation-tool px-1" aria-label="GitHub organization"><i class="bi bi-github"></i></a>
    <a href="https://cv.udl.cat/" title="Sakai" class="quarto-navigation-tool px-1" aria-label="Sakai"><i class="bi bi-person-fill"></i></a>
</div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">InformaciÃ³ del curs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Commuta la secciÃ³">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../.././course-information/schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PlanificaciÃ³</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Diapositives</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Commuta la secciÃ³">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/01-foundations-of-systems-administration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unitat 01 Â· Fonaments de lâ€™AdministraciÃ³ de Sistemes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/02-booting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unitat 02 Â· Arrencada del sistema</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/02-booting-part2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unitat 02 Â· Arrencada del sistema (Part 2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/02-booting-part3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unitat 02 Â· Arrencada del sistema (Part 3)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/03-filesystem-part1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unitat 03 Â· Sistemes de fitxers (Part 1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/03-filesystem-part2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unitat 03 Â· Sistemes de fitxers (Part 2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/03-filesystem-part3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unitat 03 Â· Sistemes de fitxers (Part 3)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/04-authentication-part1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unitat 04 Â· AutenticaciÃ³ i AutoritzaciÃ³ (Part 1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/04-authentication-part2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unitat 04 Â· AutenticaciÃ³ i AutoritzaciÃ³ (Part 2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/05-virtualization-part1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unitat 05 Â· VirtualitzaciÃ³ i Contenidors (Part 1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/05-virtualization-part2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unitat 05 Â· VirtualitzaciÃ³ i Contenidors (Part 2)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Activitats</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Commuta la secciÃ³">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Unitat 01 Â· Fonaments de lâ€™AdministraciÃ³ de Sistemes</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Commuta la secciÃ³">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/01-foundations-of-systems-administration/01-ex-week1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 1 Â· ConfiguraciÃ³ dâ€™entorn de virtualitzaciÃ³</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/01-foundations-of-systems-administration/02-ex-week1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 2 Â· EmulaciÃ³ en mode dâ€™usuari amb QEMU</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Unitat 02 Â· Arrencada del sistema</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Commuta la secciÃ³">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/02-booting/01-ex-week2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 1 Â· Booting amb MBR i BIOS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/02-booting/02-ex-week2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 2 Â· Booting amb UEFI</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/02-booting/03-ex-week2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 3 Â· Dual Boot amb UEFI</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/02-booting/04-ex-week3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 4 Â· Modificant la contrasenya de lâ€™usuari root a travÃ©s del GRUB</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/02-booting/05-ex-week3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 5 Â· Arrencada automÃ tica dâ€™una particiÃ³ LUKS amb clau en un disc secundari</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/02-booting/06-ex-week4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 6 Â· AnÃ lisi del procÃ©s dâ€™arrencada amb systemd</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/02-booting/07-ex-week4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 7 Â· Servei de CÃ²pia de Seguretat AutomÃ tica amb systemd</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Unitat 03 Â· Sistemes de fitxers</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Commuta la secciÃ³">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/03-fs/08-ex-week5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 8 Â· AdministraciÃ³ bÃ sica de Sistemes de Fitxers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/03-fs/09-ex-week6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 9 Â· ConfiguraciÃ³ de RAIDs amb mdadm</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/03-fs/10-ex-week7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 10 Â· AdministraciÃ³ de volums lÃ²gics amb LVM</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Unitat 04 Â· AutenticaciÃ³ i AutoritzaciÃ³</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Commuta la secciÃ³">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/04-accounts/01-lord-of-system.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 11 Â· GestiÃ³ de comptes en un servidor Linux</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/04-accounts/01-pam.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 12 Â· AutenticaciÃ³ de doble factor (2FA) amb PAM</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">Unitat 05 Â· VirtualitzaciÃ³ i Contenidors</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Commuta la secciÃ³">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/05-virtualitzation/01-docker.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 13 Â· IntroducciÃ³ a Docker</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Laboratoris</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Commuta la secciÃ³">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">Unitat 01 Â· Fonaments de lâ€™AdministraciÃ³ de Sistemes</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Commuta la secciÃ³">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../laboratories/01-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Laboratori Â· Fonaments de lâ€™AdministraciÃ³ de Sistemes amb AWS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../laboratories/01-foundations/01-aws-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Laboratori 01 Â· IntroducciÃ³ a AWS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../laboratories/01-foundations/02-aws-wordpress.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Laboratori 02 Â· Desplegament dâ€™una aplicaciÃ³ web amb AWS</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false">
 <span class="menu-text">Networking</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Commuta la secciÃ³">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../laboratories/02-network/01-aws-wordpress.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Laboratori 03 Â· Desplegament dâ€™una aplicaciÃ³ web amb alta disponibilitat amb AWS</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false">
 <span class="menu-text">Storage and Services</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false" aria-label="Commuta la secciÃ³">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../laboratories/03-jupyter/01-aws-jupyter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Laboratori 04 Â· Servidor de Python al Cloud amb Emmagatzematge S3 Compartit</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false">
 <span class="menu-text">Unitat 04 Â· AutenticaciÃ³ i AutoritzaciÃ³</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false" aria-label="Commuta la secciÃ³">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../laboratories/04-ldap/01-ldap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Laboratori 05 Â· Servei dâ€™AutenticaciÃ³ Centralitzada amb LDAP a AWS</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false">
 <span class="menu-text">Unitat 05 Â· VirtualitzaciÃ³ i Contenidors</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false" aria-label="Commuta la secciÃ³">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../laboratories/05-lambda/01-lambda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Laboratori 06 Â· ComputaciÃ³ Serverless amb AWS Lambda</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="true">
 <span class="menu-text">Projectes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="true" aria-label="Commuta la secciÃ³">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../projects/01-project/01-project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Projecte 1 Â· Snapshots i Backups amb systemd i initramfs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../projects/02-project/02-project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Projecte 2 Â· DiagnÃ²stic i ResoluciÃ³ dâ€™IncidÃ¨ncies</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../projects/03-project/03-project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Projecte 3 Â· Infraestructura LDAP Completa a AWS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../projects/04-project/04-project.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Projecte 4 Â· DockeritzaciÃ³ i OrquestraciÃ³ dâ€™una API a AWS</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">En aquesta pÃ gina</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">1. Introduction</a></li>
  <li><a href="#delivery" id="toc-delivery" class="nav-link" data-scroll-target="#delivery">2. Delivery</a></li>
  <li><a href="#outline" id="toc-outline" class="nav-link" data-scroll-target="#outline">3. Outline</a></li>
  <li><a href="#resources" id="toc-resources" class="nav-link" data-scroll-target="#resources">4. Resources</a>
  <ul class="collapse">
  <li><a href="#repository-template" id="toc-repository-template" class="nav-link" data-scroll-target="#repository-template">Repository template</a></li>
  <li><a href="#understanding-the-api" id="toc-understanding-the-api" class="nav-link" data-scroll-target="#understanding-the-api">Understanding the API</a></li>
  <li><a href="#the-database" id="toc-the-database" class="nav-link" data-scroll-target="#the-database">The database</a></li>
  <li><a href="#brief-summary" id="toc-brief-summary" class="nav-link" data-scroll-target="#brief-summary">Brief summary</a></li>
  </ul></li>
  <li><a href="#tasks" id="toc-tasks" class="nav-link" data-scroll-target="#tasks">5. Tasks</a>
  <ul class="collapse">
  <li><a href="#prac-4.1-dockerizing-the-api" id="toc-prac-4.1-dockerizing-the-api" class="nav-link" data-scroll-target="#prac-4.1-dockerizing-the-api">Prac-4.1: â€œDockerizingâ€ the API</a></li>
  <li><a href="#prac-4.2-moving-to-docker-compose" id="toc-prac-4.2-moving-to-docker-compose" class="nav-link" data-scroll-target="#prac-4.2-moving-to-docker-compose">Prac-4.2: Moving to Docker Compose</a></li>
  <li><a href="#prac-4.3-using-aws-ecr-and-ecs" id="toc-prac-4.3-using-aws-ecr-and-ecs" class="nav-link" data-scroll-target="#prac-4.3-using-aws-ecr-and-ecs">Prac-4.3: Using AWS ECR and ECS</a></li>
  <li><a href="#prac-4.4-merging-it-with-aws-rds" id="toc-prac-4.4-merging-it-with-aws-rds" class="nav-link" data-scroll-target="#prac-4.4-merging-it-with-aws-rds">Prac-4.4: Merging it with AWS RDS!</a></li>
  </ul></li>
  <li><a href="#sec-setup" id="toc-sec-setup" class="nav-link" data-scroll-target="#sec-setup">6. Setting up the server!</a>
  <ul class="collapse">
  <li><a href="#cloning-the-repository-and-set-it-up" id="toc-cloning-the-repository-and-set-it-up" class="nav-link" data-scroll-target="#cloning-the-repository-and-set-it-up">Cloning the repository and set it up:</a></li>
  </ul></li>
  <li><a href="#evaluation" id="toc-evaluation" class="nav-link" data-scroll-target="#evaluation">7. Evaluation</a></li>
  <li><a href="#rules" id="toc-rules" class="nav-link" data-scroll-target="#rules">8. Rules</a></li>
  <li><a href="#resources-1" id="toc-resources-1" class="nav-link" data-scroll-target="#resources-1">9. Resources</a></li>
  <li><a href="#doubts" id="toc-doubts" class="nav-link" data-scroll-target="#doubts">10. Doubts</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../projects/01-project/01-project.html">Projectes</a></li><li class="breadcrumb-item"><a href="../../projects/04-project/04-project.html">Projecte 4 Â· DockeritzaciÃ³ i OrquestraciÃ³ dâ€™una API a AWS</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">PrÃ ctica 04: DockeritzaciÃ³ i OrquestraciÃ³ dâ€™una API a AWS</h1>
<p class="subtitle lead">Unitat 5 Â· AdministraciÃ³ i Manteniment de Sistemes i Aplicacions (AMSA)</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-contents">
             <p>Jordi Mateo FornÃ©s <a href="mailto:jordi.mateo@udl.cat" class="email">jordi.mateo@udl.cat</a> </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>Aquesta prÃ ctica ha estat desenvolupada pels professors de Lleida, i enguany la fareu als dos campus:</p>
<ul>
<li>Ferran Aran Domingo</li>
<li>Oriol Agost Batalla</li>
<li>Pablo Fraile Alonso</li>
</ul>
<p>En part es tracta dâ€™una competiciÃ³ amistosa entre els dos campus per veure qui ho fa millor!</p>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">1. Introduction</h2>
<p>The objective for this assignment is to <strong>dockerize and orchestrate a provided API.</strong></p>
<p>Weâ€™ve created an <a href="https://www.postman.com/what-is-an-api/#how-do-apis-work">HTTP Server API</a>, a program that communicate between different applications by defining clear rules for how data is requested, sent, and received.</p>
<p>There are lots of different behaviours for APIs (and weâ€™ll explain how ours works in the sections bellow), but they will typically have:</p>
<ul>
<li>Endpoints: An API endpoint is a dedicated URL that provides access to a specific resource. For instance, the <em>/articles</em> endpoint in a blogging app would return all the articles of the server.</li>
<li>Method: The requestâ€™s method indicates the type of operation the client would like to perform on a given resource. REST APIs are accessible through standard HTTP methods, which perform common actions like retrieving, creating, updating, and deleting data.</li>
<li>Parameters: Parameters are the variables that are passed to an API endpoint to provide specific instructions for the API to process. These parameters can be included in the API request as part of the URL, in the query string, or in the request body. For example, the /articles endpoint of a blogging API might accept a â€œtopicâ€ parameter, which it would use to access and return articles on a specific topic.</li>
<li>Request body: The body is the main part of the request, and it includes the actual data that is required to create, update, or delete a resource. For instance, if you were creating a new article in a blogging app, the request body would likely include the articleâ€™s content, title, and author.</li>
</ul>
<p><strong>The objective of this activity is to <em>dockerize</em> and deploy to AWS our API, while also learning about databases in the way.</strong></p>
</section>
<section id="delivery" class="level2">
<h2 class="anchored" data-anchor-id="delivery">2. Delivery</h2>
<p><em>Accept the assignment in Github Classroom, <a href="https://classroom.github.com/a/3DHX45S9">following the link</a></em></p>
<p>To complete this activity, you must do the following for each sub-delivery (PRAC-4.1, PRAC-4.2, PRAC-4.3 and PRAC-4.4):</p>
<ol type="1">
<li><p>Deliver <strong>a link to your Github repository</strong> on the virtual campus activity.</p></li>
<li><p>Push the code youâ€™ve written (<strong>before the final deadline</strong>) to your Github repo so we can evaluate it.</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Consell
</div>
</div>
<div class="callout-body-container callout-body">
<p>Remember that weâ€™re only going to evaluate your assignment after the final deadline, but following the recommended tempos and pushing each part of the activity accordingly can grant you extra points.</p>
</div>
</div>
</section>
<section id="outline" class="level2">
<h2 class="anchored" data-anchor-id="outline">3. Outline</h2>
<p>This activity is split onto 4 incremental parts, which are going to be related to the contents explained during the different classes.</p>
<ol type="1">
<li>On the first week, your job will be to <strong>â€œdockerizeâ€ the API</strong>.</li>
<li>On the second week, your job will be to communicate the API with a postgresql database using docker-compose on your local PC.</li>
<li>Then, weâ€™ll want you to deploy the API to AWS.</li>
<li>Finally, after having explained the <strong>AWS Relational Database Service (RDS)</strong>, youâ€™ll connect the ECS service to your newly created RDS database.</li>
</ol>
</section>
<section id="resources" class="level2">
<h2 class="anchored" data-anchor-id="resources">4. Resources</h2>
<p>Since building the users API yourself is outside the scope of this subject, the teachers have prepared some helpful resources to make the activity quicker and more enjoyable. This way, you can focus on the fun parts: containers and AWS services!</p>
<section id="repository-template" class="level3">
<h3 class="anchored" data-anchor-id="repository-template">Repository template</h3>
<p>When you join the Github Classroom activity with the link provided on Step 2, a remote repository is automatically created for you to work on this assignment. This repository will already contain all the python code of the API, below are the details of what comes with the repo:</p>
<ol type="1">
<li><p>It has everything needed to serve the API.</p></li>
<li><p>A <code>README.md</code> file where youâ€™ll have instructions on how to set up the python environment.</p></li>
</ol>
</section>
<section id="understanding-the-api" class="level3">
<h3 class="anchored" data-anchor-id="understanding-the-api">Understanding the API</h3>
<p>How does our API work? First, <a href="../../projects/04-project/04-project.html#sec-setup">you have to setup your environment and start the server, see section 6</a>.</p>
<p>By default, the server listens for HTTP connections on port <code>8000</code>. Be aware that, this means that if youâ€™re running it on your pc (without any container), you can access it via <code>http://localhost:8000</code> on your browser. If youâ€™re running it on a conainer, youâ€™ll need to map the port of the container to your host so you can access it on your browser (see <a href="https://amsa.lol/resources/docker.html#run-a-container-given-an-image-advanced">how to map it on our reference cheatsheet</a>).</p>
<p>The API, exposes three â€œendpointsâ€, letâ€™s see them:</p>
<ul>
<li><p>(<code>GET /docs</code>) Documentation: Returns an html file (the type of files that your browser knows how to show/paint on the screen), that allows us to easily call the other two endpoints of the API. <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p></li>
<li><p>(<code>POST /users</code>) Create a user given:</p>
<ul>
<li>A username</li>
<li>A name</li>
<li>A role (â€œuserâ€ or â€œadminâ€)</li>
<li>A password</li>
</ul></li>
<li><p>(<code>GET /users</code>) List all existing users</p></li>
</ul>
<p>If you want to see the documentation and â€œplayâ€ with the <code>/users</code> endpoints, you can access <a href="http://localhost:8000/docs" class="uri">http://localhost:8000/docs</a> <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> This will allow you to create users with <code>POST http://localhost:8000/users</code>, and then retrieve the information with <code>GET http://localhost:8000/users</code>, nice!</p>
<p>If it still didnâ€™t make clear what an API really is <a href="https://www.youtube.com/watch?v=PUPDGbnpSjw">watch the hardvard cs50 http class</a>, and then think that:</p>
<ul>
<li>The <code>/docs</code> endpoint is just the same as the â€œfacebookâ€ example they show, it returns text in <code>html</code> format.</li>
<li>The other two endpoints, (<code>POST users</code> and <code>GET users</code>) receive and return text in the <a href="https://stackoverflow.blog/2022/06/02/a-beginners-guide-to-json-the-data-format-for-the-internet/">json</a> format, not <code>html</code>.</li>
</ul>
</section>
<section id="the-database" class="level3">
<h3 class="anchored" data-anchor-id="the-database">The database</h3>
<div class="callout callout-style-default callout-note callout-titled" title="Don't worry too much">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Nota</span>Donâ€™t worry too much
</div>
</div>
<div class="callout-body-container callout-body">
<p>Youâ€™ll switch and explore the databases on PRAC-4.2! Although it is recommended that you try to understand them now, so you can â€œmore or lessâ€ see, how our service works!</p>
</div>
</div>
<p>Our app needs a way to save the users information! We save it on a database, and we want to choose between different databases <a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> :</p>
<ul>
<li><p>By default, it uses an internal <a href="https://sqlite.org/index.html">sqlite</a>, which just uses a â€œrawâ€ file as the database. This means that it doesnâ€™t connect to anything, it just saves the information to an â€œoptimizedâ€ file, and thatâ€™s really it.</p></li>
<li><p>If the <code>PROD</code> environment variable is set <a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> , then it will attempt to connect to a <a href="https://www.postgresql.org">postgresql</a> database. This database is another â€œserviceâ€ on his own, that exposes a port (by default 5432), where you can connect and send values to be saved. Of course, not everyone should connect to this database, only the people with a valid username and password, thatâ€™s the reason behind that, when you create a postgresql database, you need to tell it the user and password that you want!</p></li>
</ul>
<p>Once we have an instance of postgresql running, we can tell the users api to use this instance instead of the sqlite one (This will be a requirement on Prac-4.2!). So, weâ€™ll have to tell him the following information via environment variables:</p>
<ul>
<li><code>PROD</code>: Set it to true if you want to use a postgresql instance.</li>
<li><code>DB_USER</code>: The user who will connect to the database</li>
<li><code>DB_PASSWORD</code>: The password to connect to the database</li>
<li><code>DB_HOST</code>: The IP address of the host of the database</li>
<li><code>DB_PORT</code>: The port of the host of the database</li>
<li><code>DB_NAME</code>: The name of the database inside postgresql</li>
</ul>
</section>
<section id="brief-summary" class="level3">
<h3 class="anchored" data-anchor-id="brief-summary">Brief summary</h3>
<p>A brief summary of how the app works is shown below (using user creation (<code>POST /users</code>) as an example): <img src="../../figs/projects/04-project/example-server.png" class="img-fluid"></p>
<p>Keep in mind that if youâ€™re running everything on <code>localhost</code> (which is likely the case for PRAC-4.1 and PRAC-4.2) the IP address used in the example figure will be <code>127.0.0.1</code>, or simply the domain name <code>localhost</code>. In this setup (PRAC-4.1 and PRAC-4.2), your machine acts as both the server and the client.</p>
</section>
</section>
<section id="tasks" class="level2">
<h2 class="anchored" data-anchor-id="tasks">5. Tasks</h2>
<section id="prac-4.1-dockerizing-the-api" class="level3">
<h3 class="anchored" data-anchor-id="prac-4.1-dockerizing-the-api">Prac-4.1: â€œDockerizingâ€ the API</h3>
<p>Your main objective is to <strong>â€œdockerizeâ€ the API</strong>. Thatâ€™s it, we keep it simple this week. So you should write a <code>Dockerfile</code> to run the <code>users API http server</code> inside a container. The rules are the following:</p>
<ul>
<li>Keep in mind that the command you must run inside the Docker container is <em>uv run fastapi run</em>, and that <strong>dependencies must be synced</strong> before (this means the virtual environment should be created before doing the <code>uv run</code>).</li>
<li>You must only use the sqlitedb database! This means that, in prac-4.1, you donâ€™t have to <code>docker run</code> with custom env variables, just the default ones!.</li>
<li>Remember to map the containerâ€™s port to a port on your host machine, otherwise, the server will remain isolated inside the container and you wonâ€™t be able to access it from your host.</li>
<li>If you have any questions about what youâ€™re allowed to do in the Dockerfile, please ask the teachers.</li>
</ul>
<p>Your goal should be to make the resulting image as <strong>small as possible</strong>, as thatâ€™s what good developers should do!</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Current record">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Consell</span>Current record
</div>
</div>
<div class="callout-body-container callout-body">
<p>The current record for the smallest image achieved by a Lleida student is <strong>220 MB</strong>! Can you beat it?</p>
</div>
</div>
</section>
<section id="prac-4.2-moving-to-docker-compose" class="level3">
<h3 class="anchored" data-anchor-id="prac-4.2-moving-to-docker-compose">Prac-4.2: Moving to Docker Compose</h3>
<p>Your objective is to <strong>switch the APIâ€™s db to a postgresql, and communicate it through Docker compose</strong></p>
<ol type="1">
<li>Move the <em>dockerized</em> image onto a compose service. This should be a straight-forward step.</li>
<li>Deploy a postgresql database on the compose. Donâ€™t stress on joining them yet!</li>
<li>Now itâ€™s time to communicate them.</li>
<li>Lastly, make sure that the database persists the information even if the container is removed.</li>
</ol>
<p>The resulting file should be a <code>docker-compose.yml</code> with both services and their respective configuration.</p>
<p>The topology should be something like this: <img src="../../figs/projects/04-project/internal-example.png" class="img-fluid"></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Consell
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can see the logs of the container for asserting that it is using the PostgreSQL database (you can see <a href="https://github.com/El-Despatx/cloud-template/blob/main/db/db.py#L24">the code that does this here</a> ).</p>
<p>Also, you can connect to the database and query the tables! See <a href="https://quickref.me/postgres.html">this cheatsheet for connecting and querying postgresql</a></p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Feel free to use PostgreSQL 18 or 18.1 (thereâ€™s no meaningful difference for our use case).</p>
</div>
</div>
</section>
<section id="prac-4.3-using-aws-ecr-and-ecs" class="level3">
<h3 class="anchored" data-anchor-id="prac-4.3-using-aws-ecr-and-ecs">Prac-4.3: Using AWS ECR and ECS</h3>
<p>No worries! Weâ€™ll upload it as soon as the date arrives. ğŸš§â›ï¸ğŸ‘·</p>
</section>
<section id="prac-4.4-merging-it-with-aws-rds" class="level3">
<h3 class="anchored" data-anchor-id="prac-4.4-merging-it-with-aws-rds">Prac-4.4: Merging it with AWS RDS!</h3>
<p>No worries! Weâ€™ll upload it as soon as the date arrives. ğŸš§â›ï¸ğŸ‘·</p>
</section>
</section>
<section id="sec-setup" class="level2">
<h2 class="anchored" data-anchor-id="sec-setup">6. Setting up the server!</h2>
<section id="cloning-the-repository-and-set-it-up" class="level3">
<h3 class="anchored" data-anchor-id="cloning-the-repository-and-set-it-up">Cloning the repository and set it up:</h3>
<p>Remember that, once you entered the Github Classroom on <a href="../../projects/04-project/04-project.html#delivery">section 2</a>, you will have to clone your repository with:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone <span class="op">&lt;</span>ssh_address_of_your_git_repository<span class="op">&gt;</span></span></code></pre></div><button title="Copia al porta-retalls" class="code-copy-button"><i class="bi"></i></button></div>
<p>Then, setup a virtual environment for the python project, which can be done with:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">uv</span> sync</span></code></pre></div><button title="Copia al porta-retalls" class="code-copy-button"><i class="bi"></i></button></div>
<p>Now, youâ€™re ready to run the <code>users api server</code>, do it with:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">uv</span> run fastapi run</span></code></pre></div><button title="Copia al porta-retalls" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="evaluation" class="level2">
<h2 class="anchored" data-anchor-id="evaluation">7. Evaluation</h2>
<p>Your final score will come from various parts:</p>
<ul>
<li>4.1: Docker â†’ 15%.</li>
<li>4.2: Docker-Compose â†’ 15%.</li>
<li>4.3: ECR &amp; ECS â†’ 15%.</li>
<li>4.4: RDS â†’ 15%.</li>
<li>Best practices are used â†’ 40%.
<ul>
<li>How small is your Docker image?</li>
<li>Is your compose deterministic?</li>
<li>Does your compose expose more than needed?</li>
<li>â€¦</li>
</ul></li>
</ul>
</section>
<section id="rules" class="level2">
<h2 class="anchored" data-anchor-id="rules">8. Rules</h2>
<ol type="1">
<li>It is <strong>forbidden to modify our python code (the given API)</strong>. It has everything you need and thereâ€™s no need to modify it. If you feel like modifying the code would make something better, <strong>contact the teachers before doing so</strong>.</li>
<li>In the <code>Dockerfile</code> for the user API, the dependencies must be installed in the Docker, not in runtime</li>
<li>If you are a group of 2, both of you must contribute to the repository with at least 1 commit.</li>
</ol>
</section>
<section id="resources-1" class="level2">
<h2 class="anchored" data-anchor-id="resources-1">9. Resources</h2>
<ul>
<li><a href="https://amsa.lol/resources/docker.html">Docker Commands Reference</a></li>
<li><a href="https://restfulapi.net">What are Restful APIs?</a></li>
<li><a href="https://docker-curriculum.com">Docker for beginners</a></li>
<li><a href="https://docs.docker.com/compose/gettingstarted/">Docker compose quickstart</a></li>
</ul>
</section>
<section id="doubts" class="level2">
<h2 class="anchored" data-anchor-id="doubts">10. Doubts</h2>
<p>Please donâ€™t hesitate to ask the teachers <strong>any doubts</strong>, there are no dumb questions, weâ€™re here to help.</p>
<p>You can reach us by email (find them at the top of this page) or come to our office at EPS 3.07 (weâ€™re here mostly during mornings).</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Notes a peu de pÃ gina</h2>

<ol>
<li id="fn1"><p>The <code>http://localhost:8000/docs</code> webpage, isnâ€™t the only way to â€œtestâ€ the endpoints of the API. Our server exposes a connection http on the port <code>8000</code>, so any clients that support the <code>http</code> protocol could be used instead. If youâ€™re curious, you can use another client like for example <a href="https://www.youtube.com/watch?v=PfujVETI-i4">postman (see video here)</a> or <a href="https://www.youtube.com/watch?v=Xy7fDxz39FM">if you want a cli tool that is installed on every linux distro, just use curl</a><a href="#fnref1" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn2"><p>In reality, you could also access <a href="http://localhost:8000" class="uri">http://localhost:8000</a> instead of <a href="http://localhost:8000/docs" class="uri">http://localhost:8000/docs</a>, since it will automatically redirect you to <code>/docs</code>, you can see <a href="https://github.com/El-Despatx/cloud-template/blob/main/main.py#L25https://github.com/El-Despatx/cloud-template/blob/main/main.py#L25">the code of the server that does this</a><a href="#fnref2" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn3"><p>A database is just a program that makes saving and retrieving data easy and fast. We could save our users inside a file named â€œusers.txtâ€, ex:</p>
<pre><code>1,pabloteach,Pablo Fraile,admin,4346%3450834
2,ori,Oriol Agost,admin,435-08345237
...</code></pre>
<p>But, of course, this would be slow as f**k, thatâ€™s why we use databases.<a href="#fnref3" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn4"><p>If you donâ€™t know what environment variables are (you should know it from the Operating Systems course), you can have a <a href="https://hpc-wiki.info/hpc/Introduction_to_Linux_in_HPC/Environment_variables">great explanation on the hpc-wiki</a><a href="#fnref4" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiat!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiat!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/amsa-gei-udl-2526-105013\.github\.io\/course\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>