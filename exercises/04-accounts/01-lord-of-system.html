<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ca" xml:lang="ca"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Laboratori: Gestió de comptes en un servidor Linux – AMSA - Fall 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-c30451789a0a2bcd5e941535c675cd30.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Cap resultat",
    "search-matching-documents-text": "documents que coincideixen",
    "search-copy-link-title": "Copia l'enllaç a la cerca",
    "search-hide-matches-text": "Amaga les coincidències addicionals",
    "search-more-match-text": "altra coincidència en aquest document",
    "search-more-matches-text": "altres coincidències en aquest document",
    "search-clear-button-title": "Neteja",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel·la",
    "search-submit-button-title": "Envia",
    "search-label": "Cerca"
  }
}</script>


</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Commuta la navegació de la barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Activitats</li><li class="breadcrumb-item"><a href="../../exercises/04-accounts/01-lord-of-system.html">Unitat 04 · Autenticació i Autorització</a></li><li class="breadcrumb-item"><a href="../../exercises/04-accounts/01-lord-of-system.html">Activitat 11 · Gestió de comptes en un servidor Linux</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Commuta la navegació de la barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../figs/logo.png" alt="AMSA Logo" class="sidebar-logo light-content py-0 d-lg-inline d-none">
      <img src="../../figs/logo.png" alt="AMSA Logo" class="sidebar-logo dark-content py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main tools-wide">
    <a href="../../index.html" title="Home" class="quarto-navigation-tool px-1" aria-label="Home"><i class="bi bi-house"></i></a>
    <a href="https://github.com/amsa-gei-udl-2526-105013/course/" title="GitHub organization" class="quarto-navigation-tool px-1" aria-label="GitHub organization"><i class="bi bi-github"></i></a>
    <a href="https://cv.udl.cat/" title="Sakai" class="quarto-navigation-tool px-1" aria-label="Sakai"><i class="bi bi-person-fill"></i></a>
</div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Informació del curs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Commuta la secció">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../.././course-information/schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Planificació</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Diapositives</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Commuta la secció">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/01-foundations-of-systems-administration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unitat 01 · Fonaments de l’Administració de Sistemes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/02-booting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unitat 02 · Arrencada del sistema</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/02-booting-part2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unitat 02 · Arrencada del sistema (Part 2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/02-booting-part3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unitat 02 · Arrencada del sistema (Part 3)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/03-filesystem-part1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unitat 03 · Sistemes de fitxers (Part 1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/03-filesystem-part2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unitat 03 · Sistemes de fitxers (Part 2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/03-filesystem-part3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unitat 03 · Sistemes de fitxers (Part 3)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/04-authentication-part1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unitat 04 · Autenticació i Autorització (Part 1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/04-authentication-part2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unitat 04 · Autenticació i Autorització (Part 2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/05-virtualization-part1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unitat 05 · Virtualització i Contenidors (Part 1)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Activitats</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Commuta la secció">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Unitat 01 · Fonaments de l’Administració de Sistemes</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Commuta la secció">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/01-foundations-of-systems-administration/01-ex-week1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 1 · Configuració d’entorn de virtualització</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/01-foundations-of-systems-administration/02-ex-week1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 2 · Emulació en mode d’usuari amb QEMU</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Unitat 02 · Arrencada del sistema</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Commuta la secció">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/02-booting/01-ex-week2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 1 · Booting amb MBR i BIOS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/02-booting/02-ex-week2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 2 · Booting amb UEFI</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/02-booting/03-ex-week2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 3 · Dual Boot amb UEFI</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/02-booting/04-ex-week3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 4 · Modificant la contrasenya de l’usuari root a través del GRUB</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/02-booting/05-ex-week3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 5 · Arrencada automàtica d’una partició LUKS amb clau en un disc secundari</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/02-booting/06-ex-week4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 6 · Anàlisi del procés d’arrencada amb systemd</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/02-booting/07-ex-week4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 7 · Servei de Còpia de Seguretat Automàtica amb systemd</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Unitat 03 · Sistemes de fitxers</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Commuta la secció">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/03-fs/08-ex-week5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 8 · Administració bàsica de Sistemes de Fitxers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/03-fs/09-ex-week6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 9 · Configuració de RAIDs amb mdadm</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/03-fs/10-ex-week7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 10 · Administració de volums lògics amb LVM</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Unitat 04 · Autenticació i Autorització</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Commuta la secció">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/04-accounts/01-lord-of-system.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Activitat 11 · Gestió de comptes en un servidor Linux</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/04-accounts/01-pam.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 12 · Autenticació de doble factor (2FA) amb PAM</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">Unitat 05 · Virtualització i Contenidors</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Commuta la secció">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/05-virtualitzation/01-docker.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activitat 13 · Introducció a Docker</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Laboratoris</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Commuta la secció">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">Unitat 01 · Fonaments de l’Administració de Sistemes</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Commuta la secció">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../laboratories/01-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Laboratori · Fonaments de l’Administració de Sistemes amb AWS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../laboratories/01-foundations/01-aws-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Laboratori 01 · Introducció a AWS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../laboratories/01-foundations/02-aws-wordpress.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Laboratori 02 · Desplegament d’una aplicació web amb AWS</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false">
 <span class="menu-text">Networking</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Commuta la secció">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../laboratories/02-network/01-aws-wordpress.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Laboratori 03 · Desplegament d’una aplicació web amb alta disponibilitat amb AWS</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false">
 <span class="menu-text">Storage and Services</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false" aria-label="Commuta la secció">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../laboratories/03-jupyter/01-aws-jupyter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Laboratori 04 · Servidor de Python al Cloud amb Emmagatzematge S3 Compartit</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false">
 <span class="menu-text">Unitat 04 · Autenticació i Autorització</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false" aria-label="Commuta la secció">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../laboratories/04-ldap/01-ldap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Laboratori 05 · Servei d’Autenticació Centralitzada amb LDAP a AWS</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false">
 <span class="menu-text">Projectes</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false" aria-label="Commuta la secció">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../projects/01-project/01-project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Projecte 1 · Snapshots i Backups amb systemd i initramfs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../projects/02-project/02-project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Projecte 2 · Diagnòstic i Resolució d’Incidències</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../projects/03-project/03-project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Projecte 3 · Infraestructura LDAP Completa a AWS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../projects/04-project/04-project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Projecte 4 · Dockerització i Orquestració d’una API a AWS</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">En aquesta pàgina</h2>
   
  <ul>
  <li><a href="#objectius" id="toc-objectius" class="nav-link active" data-scroll-target="#objectius">Objectius</a></li>
  <li><a href="#requisits" id="toc-requisits" class="nav-link" data-scroll-target="#requisits">Requisits</a></li>
  <li><a href="#preparant-el-servidor" id="toc-preparant-el-servidor" class="nav-link" data-scroll-target="#preparant-el-servidor">Preparant el servidor</a></li>
  <li><a href="#mostrant-informació-de-benvinguda" id="toc-mostrant-informació-de-benvinguda" class="nav-link" data-scroll-target="#mostrant-informació-de-benvinguda">Mostrant informació de benvinguda</a></li>
  <li><a href="#mostrant-informació-connexions-remotes" id="toc-mostrant-informació-connexions-remotes" class="nav-link" data-scroll-target="#mostrant-informació-connexions-remotes">Mostrant informació: Connexions remotes</a></li>
  <li><a href="#creació-de-grups" id="toc-creació-de-grups" class="nav-link" data-scroll-target="#creació-de-grups">Creació de grups</a>
  <ul class="collapse">
  <li><a href="#crea-4-grups-amb-els-següents-gids" id="toc-crea-4-grups-amb-els-següents-gids" class="nav-link" data-scroll-target="#crea-4-grups-amb-els-següents-gids">Crea 4 grups amb els següents GIDs</a></li>
  </ul></li>
  <li><a href="#creant-els-usuaris" id="toc-creant-els-usuaris" class="nav-link" data-scroll-target="#creant-els-usuaris">Creant els usuaris</a>
  <ul class="collapse">
  <li><a href="#crea-els-següents-comptes" id="toc-crea-els-següents-comptes" class="nav-link" data-scroll-target="#crea-els-següents-comptes">Crea els següents comptes</a></li>
  </ul></li>
  <li><a href="#protegint-els-comptes" id="toc-protegint-els-comptes" class="nav-link" data-scroll-target="#protegint-els-comptes">Protegint els comptes</a></li>
  <li><a href="#accés-a-la-comarca-ssh" id="toc-accés-a-la-comarca-ssh" class="nav-link" data-scroll-target="#accés-a-la-comarca-ssh">Accés a la comarca (SSH)</a></li>
  <li><a href="#gandalf-el-mag" id="toc-gandalf-el-mag" class="nav-link" data-scroll-target="#gandalf-el-mag">Gandalf, el mag</a></li>
  <li><a href="#actualitzant-usuaris" id="toc-actualitzant-usuaris" class="nav-link" data-scroll-target="#actualitzant-usuaris">Actualitzant Usuaris</a></li>
  <li><a href="#el-poder-de-lanell" id="toc-el-poder-de-lanell" class="nav-link" data-scroll-target="#el-poder-de-lanell">El poder de l’anell</a></li>
  <li><a href="#final-del-viatge" id="toc-final-del-viatge" class="nav-link" data-scroll-target="#final-del-viatge">Final del viatge</a></li>
  <li><a href="#notificació-de-la-comarca" id="toc-notificació-de-la-comarca" class="nav-link" data-scroll-target="#notificació-de-la-comarca">Notificació de la comarca</a>
  <ul class="collapse">
  <li><a href="#configuració-del-postfix" id="toc-configuració-del-postfix" class="nav-link" data-scroll-target="#configuració-del-postfix">Configuració del postfix</a></li>
  <li><a href="#configurant-el-dimoni" id="toc-configurant-el-dimoni" class="nav-link" data-scroll-target="#configurant-el-dimoni">Configurant el dimoni</a></li>
  <li><a href="#prova" id="toc-prova" class="nav-link" data-scroll-target="#prova">Prova</a></li>
  </ul></li>
  <li><a href="#entregable" id="toc-entregable" class="nav-link" data-scroll-target="#entregable">Entregable</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Activitats</li><li class="breadcrumb-item"><a href="../../exercises/04-accounts/01-lord-of-system.html">Unitat 04 · Autenticació i Autorització</a></li><li class="breadcrumb-item"><a href="../../exercises/04-accounts/01-lord-of-system.html">Activitat 11 · Gestió de comptes en un servidor Linux</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Laboratori: Gestió de comptes en un servidor Linux</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="objectius" class="level2">
<h2 class="anchored" data-anchor-id="objectius">Objectius</h2>
<ul>
<li>Aprendre a gestionar comptes en servidors UNIX/Linux.</li>
<li>Familiaritzar-se amb els mecanismes de protecció i control d’usuaris.</li>
</ul>
</section>
<section id="requisits" class="level2">
<h2 class="anchored" data-anchor-id="requisits">Requisits</h2>
<p>En aquesta pràctica, es demana que es creïn comptes d’usuari en un sistema Linux. Aquests comptes hauran de ser creats amb diferents permisos i restriccions, i s’hauran de configurar els grups i els permisos de fitxers i directoris per a cada usuari. Per tant, reviseu les comandes i els conceptes següents abans de començar:</p>
<ul>
<li><strong>useradd</strong>: Aquesta comanda s’utilitza per crear nous usuaris en un sistema Linux. Cada usuari té un identificador únic (<strong>UID</strong>) i pot ser assignat a un o més grups. Aquesta comanda també pot crear els directoris inicials (home directories) pels usuaris.</li>
<li><strong>groupadd</strong>: Aquesta comanda s’utilitza per crear nous grups en un sistema Linux. Els grups són una manera de gestionar col·leccions d’usuaris, permetent una administració eficaç de permisos i accés als recursos del sistema. Els grups ajuden a organitzar i controlar els usuaris amb un mateix conjunt de permisos.</li>
<li><strong>usermod</strong>: Aquesta comanda s’utilitza per modificar els atributs d’un usuari en un sistema Linux. Aquests atributs poden incloure el nom de l’usuari, el directori home, el grup principal, el shell, el UID, el GID, etc.</li>
<li><strong>passwd</strong>: Aquesta comanda s’utilitza per canviar la contrasenya d’un usuari en un sistema Linux. Aquesta comanda permet als usuaris canviar la seva pròpia contrasenya o als administradors canviar la contrasenya d’altres usuaris.</li>
<li><strong>chown</strong>: Aquesta comanda s’utilitza per canviar el propietari i el grup d’un fitxer o directori en un sistema Linux. Aquesta comanda permet als usuaris canviar el propietari i el grup d’un fitxer o directori, sempre que tinguin els permisos necessaris.</li>
<li><strong>chmod</strong>: Aquesta comanda s’utilitza per canviar els permisos d’un fitxer o directori en un sistema Linux. Aquesta comanda permet als usuaris canviar els permisos d’un fitxer o directori, especificant els permisos per a propietaris, grups i altres usuaris.</li>
<li><strong>setfacl/getfacl</strong>: Aquestes comandes s’utilitzen per establir i obtenir llistes de control d’accés (ACL) en un sistema Linux. Les ACL són una manera de controlar l’accés als fitxers i directoris, permetent als usuaris especificar permisos més detallats que els permisos tradicionals de propietari, grup i altres usuaris.</li>
</ul>
</section>
<section id="preparant-el-servidor" class="level2">
<h2 class="anchored" data-anchor-id="preparant-el-servidor">Preparant el servidor</h2>
<p>Instancieu un servidor <strong>AMI Linux</strong> a la plataforma <strong>AWS</strong>. Aquest servidor serà el vostre <strong>Middlearth</strong>.</p>
<ol type="1">
<li>Actualitzar totes les llibreries amb <code>sudo dnf update -y</code>.</li>
<li>Instal·lar un editor de text (vim o nano) amb <code>sudo dnf install vim -y</code>.</li>
<li>Instal·lar la shell tcsh amb <code>sudo dnf install tcsh -y</code>.</li>
<li>Actualitzar el nom de l’amfitrió amb: <code>sudo hostnamectl set-hostname middlearth</code>.</li>
</ol>
</section>
<section id="mostrant-informació-de-benvinguda" class="level2">
<h2 class="anchored" data-anchor-id="mostrant-informació-de-benvinguda">Mostrant informació de benvinguda</h2>
<p>El fitxer <strong>/etc/motd</strong> és l’arxiu on es guarda un missatge de benvinguda; normalment és un arxiu de text senzill que es mostra als usuaris quan inicien sessió. Pot contenir informació com la benvinguda al sistema, informació d’actualitat, polítiques de l’empresa, enllaços a recursos importants o qualsevol altra cosa que es consideri útil per als usuaris en el moment d’iniciar sessió.</p>
<p>Copieu el text següent al fitxer <strong>/etc/motd</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode txt code-with-copy"><code class="sourceCode default"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>#                Bienvenido a la tierra media!                  #</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>#                            *  *  *                            #</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>#                         *  *  *  *  *                         #</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>#                      *  *  *  *  *  *  *                      #</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>#                      *  *  *  *  *  *  *                      #</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>#                      *  *  *  *  *  *  *                      #</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>#                         *  *  *  *  *                         #</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>#                            *  *  *                            #</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a># El hogar está atrás, el mundo por delante, y ha               #</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a># y muchos caminos que recorrer a través de la                  #</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a># sombras hasta el borde de la noche, hasta que                 #</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a># las estrellas estén encendidas                                #</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>#################################################################</span></code></pre></div><button title="Copia al porta-retalls" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">sudo</span> vim /etc/motd </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Afegiu la informació a l'arxiu.</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a> <span class="bu">exit</span></span></code></pre></div><button title="Copia al porta-retalls" class="code-copy-button"><i class="bi"></i></button></div>
<p>Tornem a iniciar sessió <strong>SSH</strong>. Per veure el nostre banner, després de fer <em>login</em>.</p>
</section>
<section id="mostrant-informació-connexions-remotes" class="level2">
<h2 class="anchored" data-anchor-id="mostrant-informació-connexions-remotes">Mostrant informació: Connexions remotes</h2>
<p>L’arxiu <strong>/etc/issue.net</strong> és similar al missatge del dia (<strong>/etc/motd</strong>), però aquest s’utilitza per mostrar un missatge als usuaris abans que aquests s’autentiquin en un servidor mitjançant protocols com <em>SSH</em>. Aquest missatge normalment conté informació bàsica o una benvinguda als usuaris quan intenten connectar-se al servidor.</p>
<p>Per activar-ho:</p>
<ol type="1">
<li>Copieu el contingut del fitxer <em>/etc/issue.net</em> a <em>/etc/issue.net.default</em>. D’aquesta manera sempre mantindrem una còpia del fitxer original sense editar.</li>
<li>Copieu el següent text al fitxer <em>/etc/issue.net</em>:</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode txt code-with-copy"><code class="sourceCode default"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>#################################################################</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>#                   _    _           _   _                      #</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>#                  / \  | | ___ _ __| |_| |                     #</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>#                 / _ \ | |/ _ \ '__| __| |                     #</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>#                / ___ \| |  __/ |  | |_|_|                     #</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>#               /_/   \_\_|\___|_|   \__(_)                     #</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>#                                                               #</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>#               You are entering into Mordor!                   #</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>#   Username has been noted and has been sent to the server     #</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>#                       administrator!                          #</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>#################################################################</span></code></pre></div><button title="Copia al porta-retalls" class="code-copy-button"><i class="bi"></i></button></div>
<p>Finalment, tornem a iniciar sessió <strong>SSH</strong>. Per veure el nostre banner.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">sudo</span> cp /etc/issue.net /etc/issue.net.default</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ex">&nbsp;sudo</span> vim /etc/issue.net</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Copieu el text</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Guardar i sortir</span></span></code></pre></div><button title="Copia al porta-retalls" class="code-copy-button"><i class="bi"></i></button></div>
<p>Per podeu veure el banner, s’ha d’editar la configuració del servei SSH:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> vim /etc/ssh/sshd_config</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Descomentar </span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="ex">Banner</span> /etc/issue.net</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Guardar i sortir</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl restart sshd</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="bu">exit</span></span></code></pre></div><button title="Copia al porta-retalls" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="creació-de-grups" class="level2">
<h2 class="anchored" data-anchor-id="creació-de-grups">Creació de grups</h2>
<p>La comanda <strong>groupadd</strong> s’utilitza per crear nous grups en un sistema Linux. Els grups són una manera de gestionar col·leccions d’usuaris, permetent una administració eficaç de permisos i accés als recursos del sistema. Els grups ajuden a organitzar i controlar els usuaris amb un mateix conjunt de permisos.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">groupadd</span> <span class="pp">[</span><span class="ss">opcions</span><span class="pp">]</span> nom_del_grup</span></code></pre></div><button title="Copia al porta-retalls" class="code-copy-button"><i class="bi"></i></button></div>
<section id="crea-4-grups-amb-els-següents-gids" class="level3">
<h3 class="anchored" data-anchor-id="crea-4-grups-amb-els-següents-gids">Crea 4 grups amb els següents GIDs</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>nom</strong></th>
<th><strong>GID</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>hobbits</td>
<td>6000</td>
</tr>
<tr class="even">
<td>elfs</td>
<td>7000</td>
</tr>
<tr class="odd">
<td>nans</td>
<td>8000</td>
</tr>
<tr class="even">
<td>mags</td>
<td>9000</td>
</tr>
</tbody>
</table>
<ul>
<li>Utilitza la comanda <em>groupadd</em> per crear els grups amb els GIDs especificats.</li>
<li>Prepara un script bash que creï els grups automàticament.</li>
</ul>
</section>
</section>
<section id="creant-els-usuaris" class="level2">
<h2 class="anchored" data-anchor-id="creant-els-usuaris">Creant els usuaris</h2>
<p>La comanda <em>useradd</em> s’utilitza per crear nous usuaris en un sistema Linux. Cada usuari té un identificador únic (<strong>UID</strong>) i pot ser assignat a un o més grups. Aquesta comanda també pot crear els directoris inicials (home directories) pels usuaris.</p>
<section id="crea-els-següents-comptes" class="level3">
<h3 class="anchored" data-anchor-id="crea-els-següents-comptes">Crea els següents comptes</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>usuari</strong></th>
<th><strong>UID</strong></th>
<th><strong>GID</strong></th>
<th><strong>nom</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>frodo</td>
<td>6001</td>
<td>6000</td>
<td>Frodo</td>
</tr>
<tr class="even">
<td>gollum</td>
<td>6002</td>
<td>6000</td>
<td>Smeagol</td>
</tr>
<tr class="odd">
<td>samwise</td>
<td>6003</td>
<td>6000</td>
<td>Samwise</td>
</tr>
<tr class="even">
<td>legolas</td>
<td>7001</td>
<td>7000</td>
<td>Legolas</td>
</tr>
<tr class="odd">
<td>gimli</td>
<td>8001</td>
<td>8000</td>
<td>Gimli</td>
</tr>
<tr class="even">
<td>gandalf</td>
<td>9001</td>
<td>9000</td>
<td>Gandalf</td>
</tr>
</tbody>
</table>
<ul>
<li>Utilitza la comanda <em>useradd</em> per crear els usuaris amb els UIDs i GIDs especificats.</li>
<li>Prepara un script bash que creï els usuaris automàticament.</li>
</ul>
</section>
</section>
<section id="protegint-els-comptes" class="level2">
<h2 class="anchored" data-anchor-id="protegint-els-comptes">Protegint els comptes</h2>
<p>S’ha de requerir contrasenyes robustes per als comptes d’usuari. De manera predeterminada, tots els comptes d’usuari tenen assignada la contrasenya <em>Tolkien2LOR</em>. Un cop l’usuari es connecti per primera vegada, haurà de canviar la contrasenya. A més, s’ha de configurar el sistema perquè bloquegi els comptes d’usuari després de 3 intents fallits.</p>
<ol type="1">
<li><p>Assigna la contrasenya <em>Tolkien2LOR</em> a tots els usuaris.</p></li>
<li><p>Configura el sistema per bloquejar els comptes d’usuari després de 3 intents fallits durant 120 segons. D’aquesta manera, prevenim els atacs de força bruta i protegim els comptes d’usuari. Per fer-ho, podem utilitzar <strong>faillock</strong> en versions més recents de <strong>RHEL</strong>. En versions anteriors, es podia utilitzar <strong>pam_tally2</strong>.</p></li>
<li><p>Configura polítiques de contrasenyes més fortes, heu de requerir que les contrasenyes tinguin almenys 12 caràcters, incloguin majúscules, minúscules, números i caràcters especials.</p></li>
<li><p>Requereix el canvi de contrasenya en el primer inici de sessió.</p></li>
</ol>
</section>
<section id="accés-a-la-comarca-ssh" class="level2">
<h2 class="anchored" data-anchor-id="accés-a-la-comarca-ssh">Accés a la comarca (SSH)</h2>
<p>Configura el servidor SSH per permetre l’accés als usuaris Frodo, Samwise, Legolas i Gimli utilitzant contrasenya. L’usuari Gandalf ha de poder accedir al sistema utilitzant una clau SSH. No s’ha de permetre l’accés a l’usuari Gollum o a l’usuari root.</p>
<ol type="1">
<li><p>Configura el servidor SSH per permetre l’accés als usuaris Frodo, Samwise, Legolas i Gimli utilitzant contrasenya. Per fer-ho, edita el fitxer de configuració del servei SSH <strong>/etc/ssh/sshd_config</strong> i les seves opcions.</p>
<blockquote class="blockquote">
<p>Nota: La instancia EC2 de RedHat utilitza el fitxer de configuració <strong>/etc/ssh/sshd_config/50-cloud-init.conf</strong> per configurar el servei SSH. Aquest fitxer s’inclou en el fitxer de configuració principal <strong>/etc/ssh/sshd_config</strong>.</p>
</blockquote></li>
<li><p>Genera un parell de claus SSH per a l’usuari Gandalf i afegeix la clau pública al fitxer <strong>~/.ssh/authorized_keys</strong> de l’usuari Gandalf, guarda la seva clau pública i privada a <code>/home/gandalf/.ssh/</code>. Assegura’t que els permisos del directori <code>.ssh</code> i del fitxer <code>authorized_keys</code> siguin correctes. Permet l’accés SSH sense contrasenya per a l’usuari Gandalf utilitzant la clau SSH.</p></li>
<li><p>Bloqueja l’accés a l’usuari Gollum.</p></li>
</ol>
</section>
<section id="gandalf-el-mag" class="level2">
<h2 class="anchored" data-anchor-id="gandalf-el-mag">Gandalf, el mag</h2>
<ol type="1">
<li><p>Descriu quins passos heu seguit per permetre que l’usuari Gandalf tingui permisos de <strong>root</strong>. Assuemix que existeix al sistema un grup anomenat <strong>wheel</strong> que té permisos de <strong>root</strong>.</p></li>
<li><p>En les instancies EC2 d’Amazon Linux, el grup <strong>wheel</strong> no està habilitat per defecte. Cerca a EC2 el fitxer on es defineixen els usuaris amb permisos de <strong>sudo</strong>, com l’usuari <strong>ec2-user</strong>.</p></li>
<li><p>Utilitza l’eina <strong>visudo</strong> per editar el fitxer <strong>/etc/sudoers</strong> i afegeix les línies necessàries per permetre que l’usuari <strong>gandalf</strong> utilitzi la comanda <strong>sudo</strong>.</p></li>
</ol>
</section>
<section id="actualitzant-usuaris" class="level2">
<h2 class="anchored" data-anchor-id="actualitzant-usuaris">Actualitzant Usuaris</h2>
<ul>
<li>L’usuari <strong>gollum</strong> vol tenir el seu <em>home</em> amb el nom <strong>smeagol</strong>.</li>
<li>L’usuari <strong>legolas</strong> vol tenir per defecte la <em>shell tcsh</em>.</li>
<li>L’usuari <strong>gimli</strong> no vol tenir <em>contrasenya</em>.</li>
</ul>
</section>
<section id="el-poder-de-lanell" class="level2">
<h2 class="anchored" data-anchor-id="el-poder-de-lanell">El poder de l’anell</h2>
<ul>
<li>Crearem un directori <strong>/anell</strong>.</li>
<li>Crearem un grup portadors.</li>
<li>Assignarem a frodo com a propietari del directori <strong>/anell</strong>.</li>
<li>Modificarem els permisos del directori: Els fitxers d’aquest directori únicament podran ser <strong>executats/editats</strong> per l’usuari <strong>Frodo</strong>, la resta d’usuaris no ha de tenir cap permís ni de lectura, a excepció del grup d’usuari del grup <strong>portadors</strong> que <em>han de poder llegir el directori</em>.</li>
<li>En <strong>Frodo</strong> ha de poder executar tots els fitxers del director <strong>/anell/bin</strong> sense haver d’afegir tota la ruta, únicament indicant el nom de l’executable.</li>
</ul>
</section>
<section id="final-del-viatge" class="level2">
<h2 class="anchored" data-anchor-id="final-del-viatge">Final del viatge</h2>
<ul>
<li><p>Gimli es confon amb tots els missatges que apareixen a la pantalla quan inicia sessió. Configureu el seu compte perquè no es mostri cap missatge a la pantalla quan comenci la sessió.</p></li>
<li><p>No s’ha de permetre que en Gimli executi programes des del seu propi directori <strong>/home</strong>. Per fer-ho heu d’utilitzar (<strong>setfacl</strong>):</p></li>
<li><p>L’usuari Samwise s’ha perdut i ha acabat a Narnia, elimineu-lo de l’univers.</p></li>
</ul>
</section>
<section id="notificació-de-la-comarca" class="level2">
<h2 class="anchored" data-anchor-id="notificació-de-la-comarca">Notificació de la comarca</h2>
<p>Un cop s’han creat els usuaris entrarem al sistema com a <strong>frodo</strong> i enviarem un <em>mail</em> a la resta amb el següent missatge: <strong>Benvinguts a la companyia, anem direcció mordor</strong>.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> dnf <span class="at">-y</span> install postfix</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> dnf <span class="at">-y</span> install s-nail</span></code></pre></div><button title="Copia al porta-retalls" class="code-copy-button"><i class="bi"></i></button></div>
<p>Postfix és un programari de servidor de correu electrònic que té com a objectiu principal gestionar l’enviament, recepció i l’encaminament de correus electrònics en un entorn de servidor. És conegut per la seva eficiència, seguretat i flexibilitat, i és àmpliament utilitzat en servidors de correu electrònic en tot el món.</p>
<section id="configuració-del-postfix" class="level3">
<h3 class="anchored" data-anchor-id="configuració-del-postfix">Configuració del postfix</h3>
<p>Editeu el fitxer <em>/etc/postfix/main.cf</em>:</p>
<ul>
<li><strong>myhostname</strong> = mail.middlearth.udl.cat</li>
<li><strong>mydomain</strong> = udl.cat</li>
<li><strong>myorigin</strong> = $mydomain</li>
<li><strong>inet_interfaces</strong> = all</li>
<li><strong>inet_protocols</strong> = ipv4</li>
<li><strong>mydestination</strong> = $myhostname, localhost.$mydomain, localhost, $mydomain</li>
<li><strong>mynetworks</strong> = 127.0.0.0/8</li>
<li><strong>home_mailbox</strong> = Maildir/</li>
</ul>
<p>Afegiu al final del fitxer <em>/etc/postfix/main.cf</em>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode conf code-with-copy"><code class="sourceCode toml"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Amaga el tipus o la versió del programari SMTP</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="dt">smtpd_banner</span> <span class="op">=</span> <span class="er">$</span><span class="dt">myhostname</span> <span class="dt">ESMTP</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Afegeix el següent al final</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Desactiva la comanda SMTP VRFY</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="dt">disable_vrfy_command</span> <span class="op">=</span> <span class="dt">yes</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Requereix la comanda HELO als amfitrions emissors</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="dt">smtpd_helo_required</span> <span class="op">=</span> <span class="dt">yes</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Límit de mida d'un correu electrònic</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemple a continuació significa límit de 10M bytes</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="dt">message_size_limit</span> <span class="op">=</span> <span class="dv">10240000</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Configuracions SMTP-Auth</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="dt">smtpd_sasl_type</span> <span class="op">=</span> <span class="dt">dovecot</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="dt">smtpd_sasl_path</span> <span class="op">=</span> <span class="dt">private</span><span class="er">/</span><span class="dt">auth</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="dt">smtpd_sasl_auth_enable</span> <span class="op">=</span> <span class="dt">yes</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="dt">smtpd_sasl_security_options</span> <span class="op">=</span> <span class="dt">noanonymous</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="dt">smtpd_sasl_local_domain</span> <span class="op">=</span> <span class="er">$</span><span class="dt">myhostname</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="dt">smtpd_recipient_restrictions</span> <span class="op">=</span> <span class="dt">permit_mynetworks</span><span class="er">,</span> <span class="dt">permit_auth_destination</span><span class="er">,</span> <span class="dt">permit_sasl_authenticated</span><span class="er">,</span> <span class="dt">reject</span></span></code></pre></div><button title="Copia al porta-retalls" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="configurant-el-dimoni" class="level3">
<h3 class="anchored" data-anchor-id="configurant-el-dimoni">Configurant el dimoni</h3>
<ul>
<li>Arrancant el dimoni</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl enable <span class="at">--now</span> postfix</span></code></pre></div><button title="Copia al porta-retalls" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="prova" class="level3">
<h3 class="anchored" data-anchor-id="prova">Prova</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">su</span> <span class="at">-</span> ganfalf</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Benvinguts a la companyia, anem direcció mordor."</span> <span class="kw">|</span> <span class="ex">mail</span> <span class="at">-s</span> <span class="st">"Notificació de la comarca"</span> frodo@localhost</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">su</span> <span class="at">-</span> frodo</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="ex">mail</span></span></code></pre></div><button title="Copia al porta-retalls" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="entregable" class="level2">
<h2 class="anchored" data-anchor-id="entregable">Entregable</h2>
<ul>
<li>Cal un document on s’expliquin tots els passos seguits per completar l’exercici amb les comandes utilitzades i captures de pantalla quan sigui necessari.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiat!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiat!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/amsa-gei-udl-2526-105013\.github\.io\/course\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>